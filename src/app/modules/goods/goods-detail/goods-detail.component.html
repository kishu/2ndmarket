<ng-container *ngIf="goods$ | async as goods">
  <div class="goodsDetail w-full">
    <div class="sticky-wrap z-30">
      <div app-header class="sticky safe-top"></div>
      <div *ngIf="goods.images.length > 0" class="max-w-xl mx-auto"><img [src]="goods.images[0]" alt=""></div>
    </div>
    <div class="sticky-wrap z-20 max-w-xl mx-auto bg-white">
      <div class="sticky safe-top z-20">
        <div class="goods-name overflow-hidden">
          <h2 class="goodsName">{{ goods.name }} {{ goods.name }} {{ goods.name }} {{ goods.name }} {{ goods.name }}</h2>
          <div class="flex mt-3 justify-between">
            <div class="flex-grow"><strong class="font-bold">{{ goods.price | number:'2.' }}</strong>원</div>
            <div class="flex-shrink-0">
              <span>{{ favoriteCount$ | async }}</span>
              <button type="button" [disabled]="permission$ | async" class="btn-sm" (click)="onClickFavorite()">좋<span *ngIf="favorited$ | async">(했)</span></button>
              <ng-container *ngIf="permission$ | async">
                <a [routerLink]="['edit']" class="btn btn-sm" skipLocationChange>수정</a> |
                <button type="button" class="btn-sm" (click)="onClickDelete()">삭제</button> |
                <button type="button" class="btn-sm" (click)="onClickSoldOut()">{{ goods.soldOut ? '판매됨' : '판매완료하기' }}</button>
                <span *ngIf="goods.soldOut">{{ goods.soldOut | fsTimestamp | formatDistanceToNow }}</span>
              </ng-container>
            </div>
          </div>
        </div>
      </div>
      <div class="px-4 py-3">
        <p class="leading-tight">{{ goods.memo }}</p>
        <div class="my-3 text-sm">
          <span class="inline-block py-1 px-3 mr-1 bg-gray-500 text-white"># {{ goods.condition }}</span>
          <span class="inline-block py-1 px-3 mr-1 bg-gray-500 text-white"># {{ goods.purchased }}</span>
        </div>
        <ng-container *ngIf="goods.images.length > 1">
          <div *ngIf="goods.processing" class="text-lg">
            이미지를 처리하고 있습니다.
          </div>
          <ul class="goods-images">
            <ng-container *ngFor="let src of goods.images; first as isFirst">
              <li class="relative border border-white" *ngIf="!isFirst">
                <div class="attachImage"><img [src]="src" class="image" alt=""></div>
              </li>
            </ng-container>
          </ul>
        </ng-container>
        <div>{{ goods.contact }}</div>
      </div>
    </div>
    <div class="comment-wrap relative pt-4">
      <div app-goods-comment-form class="block sticky z-10" style="top: calc(100% - 152px);" [goodsId]="goods.id"></div>
      <div app-goods-comment-list class="p-4 pt-0" style="margin-top: -152px; padding-bottom: 160px;" [goods]="goods"></div>
    </div>
  </div>
</ng-container>

<ng-container *ngIf="empty$ | async">
  <div>상품이 없습니다.</div>
</ng-container>
