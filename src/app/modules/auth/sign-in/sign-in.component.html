<h2>이메일 인증</h2>

<ng-container *ngIf="step==='email'">
  <p>
    이메일을 입력하세요.<br>
    이메일을 통해 인증번호를 전송합니다.
  </p>
  <form
    [formGroup]="emailForm"
    (ngSubmit)="submitEmail()">
    <div>
      <label for="email">이메일 주소</label>
      <input
        type="text"
        id="email"
        name="email"
        formControlName="account"
        required>
      @
      <label for="domain" style="display:none">도메인</label>
      <select
        id="domain"
        name="domain"
        formControlName="domain"
        required>
        <option value="">도메인 선택</option>
        <option value="webtoonscorp.com">webtoonscorp.com</option>
        <option value="navercorp.com">navercorp.com</option>
      </select>
    </div>
    <div *ngIf="account.invalid && (account.dirty || account.touched)">
      이메일 계정을 입력하세요.
    </div>
    <div *ngIf="domain.invalid && (domain.dirty || domain.touched)">
      이메일 도메인을 선택하세요.
    </div>
    <div>
      <button
        type="submit"
        [disabled]="!emailForm.valid">
        {{ submitting ? '보내는 중...' : '이메일 보내기' }}
      </button>
    </div>
  </form>
</ng-container>

<ng-container *ngIf="step==='code'">
  <form
    [formGroup]="codeForm"
    (ngSubmit)="submitCode()">
    <div>
      {{ account.value }}@{{ domain.value }}(으)로 인증번호를 보냈습니다.<br/>
      이메일을 확인해 인증번호를 입력하세요.
    </div>
    <div>
      <input
        type="text"
        id="code"
        name="code"
        formControlName="code"
        required />
      <app-limit-timer
        [time]="1000 * 60 * 4"
        (finished)="onFinishedLimitTimer()"></app-limit-timer>
    </div>
    <div *ngIf="code.invalid && (code.dirty || code.touched)">
      인증코드를 입력하세요.
    </div>
    <div *ngIf="finishedLimitTimer">
      입력시간이 지났습니다. 이메일을 다시 보내세요.
    </div>
    <div>
      <button type="submit" [disabled]="finishedLimitTimer || !codeForm.valid">확인</button>
      <button type="button" (click)="retry()">이메일 다시 보내기</button>
    </div>
  </form>
</ng-container>
