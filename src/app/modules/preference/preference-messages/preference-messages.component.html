<ng-container *ngIf="messageExts$ | async as messages">
  <div class="fixed left-0 header-top w-full z-30">
    <div class="px-safe border-b border-green-700 bg-white bg-opacity-95 shadow">
      <div class="relative w-full mx-auto px-12">
        <div class="absolute inset-y-0 left-0 flex">
          <button type="button" class="p-3 border-0 flex items-center" (click)="onClickHistoryBack()">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-arrow-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2f855a" fill="none" stroke-linecap="round" stroke-linejoin="round">
              <path stroke="none" d="M0 0h24v24H0z"/>
              <line x1="5" y1="12" x2="19" y2="12" />
              <line x1="5" y1="12" x2="11" y2="18" />
              <line x1="5" y1="12" x2="11" y2="6" />
            </svg>
          </button>
        </div>
        <h1 class="h-12 p-3 text-center font-bold text-green-700 ellipsis">
          알림
        </h1>
      </div>
    </div>
  </div>
  <div class="pb-safe">
    <div class="sticky-wrap px-safe">
      <h2 class="sticky safe-top z-20 border-b border-green-900 border-opacity-50 bg-white text-white flex justify-between items-center">
        <span class="flex-grow px-4 py-2 bg-green-800 opacity-50 text-sm leading-snug text-white">새 알림 {{messages.length}}개</span>
      </h2>
      <ul class="-mt-px">
        <li
          class="relative border-t px-4 py-12 text-center text-gray-500 text-sm"
          *ngIf="messages.length === 0">
          새로운 알림이 없습니다.
        </li>
        <li
          #messageEl
          class="relative border-t border-gray-300"
          *ngFor="let message of messages trackBy:trackById; first as isFirst" [id]="message.id">
          <a
            class="flex justify-between items-start px-4 py-3"
            [ngClass]="{'bg-gray-200': message.read && false}"
            [routerLink]="['/goods', message.goodsId]"
            [fragment]="'goodsComments/' + message.goodsCommentId"
            (click)="onClickMessage($event, message)">
            <div class="mr-3">
              <p class="mb-1 text-xs text-gray-600">
                새 댓글이 달렸습니다.
                <span class="text-gray-400">{{ message.created | fsTimestamp | formatDistanceToNow }} 전</span>
              </p>
              <p class="text-sm text-gray-700 leading-tight">
                <ng-container *ngIf="message.goodsComment.profileId | fsDocument:'profiles' | async as profile">
                  <span class="text-green-900 opacity-50">{{ profile.displayName }}</span>
                </ng-container>
                {{ message.goodsComment.body }}
              </p>
            </div>
            <img [src]="message.goods.images[0]" class="w-16 h-12 object-cover rounded-sm">
          </a>
          <!-- <button
            type="button"
            class="absolute right-0 top-0 mr-2 mt-1 p-1 border-transparent bg-transparent"
            (click)="onClickDeleteNotice(message, messageEl)">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#cbd5e0" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
          </button> -->
        </li>
      </ul>
    </div>
    <div class="sticky-wrap px-safe">
      <h2 class="sticky safe-top z-20 border-b border-green-900 border-opacity-50 bg-white text-white flex justify-between items-center">
        <span class="flex-grow px-4 py-2 bg-green-800 opacity-50 text-sm leading-snug text-white">읽은 알림 {{messages.length}}개</span>
      </h2>
      <ul class="-mt-px">
        <li
          class="relative border-t px-4 py-12 text-center text-gray-500 text-sm"
          *ngIf="messages.length === 0">
          알림이 없습니다.
        </li>
        <li
          #messageEl
          class="relative border-t border-gray-300"
          *ngFor="let message of messages trackBy:trackById; first as isFirst" [id]="message.id">
          <a
            class="flex justify-between items-start px-4 py-3"
            [ngClass]="{'bg-gray-200': message.read}"
            [routerLink]="['/goods', message.goodsId]"
            [fragment]="'goodsComments/' + message.goodsCommentId"
            (click)="onClickMessage($event, message)">
            <div class="mr-3">
              <p class="mb-1 text-xs text-gray-600">
                새 댓글이 달렸습니다.
                <span class="text-gray-400">{{ message.created | fsTimestamp | formatDistanceToNow }} 전</span>
              </p>
              <p class="text-sm text-gray-700 leading-tight">
                <ng-container *ngIf="message.goodsComment.profileId | fsDocument:'profiles' | async as profile">
                  <span class="text-green-900 opacity-50">{{ profile.displayName }}</span>
                </ng-container>
                {{ message.goodsComment.body }}
              </p>
            </div>
            <img [src]="message.goods.images[0]" class="w-16 h-12 object-cover rounded-sm">
          </a>
          <!-- <button
            type="button"
            class="absolute right-0 top-0 mr-2 mt-1 p-1 border-transparent bg-transparent"
            (click)="onClickDeleteNotice(message, messageEl)">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#cbd5e0" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
          </button> -->
        </li>
      </ul>
    </div>
  </div>
</ng-container>
